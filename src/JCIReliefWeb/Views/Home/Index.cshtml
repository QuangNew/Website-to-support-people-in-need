@{
    ViewData["Title"] = "Trang chủ";
}

<div class="home-page">
    <!-- Hero Section -->
    <section class="hero-section mb-4">
        <div class="hero-content">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <span class="hero-badge">
                        <i class="fa-solid fa-circle text-success me-1" style="font-size: 8px;"></i>
                        Chiến dịch đang diễn ra
                    </span>
                    <h1 class="hero-title">Chung lòng mùa lũ 2026</h1>
                    <p class="hero-description">
                        Cùng JCI chung tay hỗ trợ đồng bào miền Trung vượt qua thiên tai, 
                        mang đến hy vọng và sự ấm áp cho những hoàn cảnh khó khăn.
                    </p>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="stat-number">387.5M</span>
                            <span class="stat-label">VNĐ đã quyên góp</span>
                        </div>
                        <div class="hero-stat">
                            <span class="stat-number">1,245</span>
                            <span class="stat-label">Mạnh thường quân</span>
                        </div>
                        <div class="hero-stat">
                            <span class="stat-number">156</span>
                            <span class="stat-label">Tình nguyện viên</span>
                        </div>
                    </div>
                    <div class="hero-actions">
                        <a href="/Sponsor" class="btn btn-primary btn-lg">
                            <i class="fa-solid fa-heart me-2"></i>Quyên góp ngay
                        </a>
                        <a href="/Volunteer" class="btn btn-outline-primary btn-lg">
                            <i class="fa-solid fa-hands-helping me-2"></i>Tình nguyện viên
                        </a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="hero-image">
                        <img src="https://via.placeholder.com/600x400/2563eb/ffffff?text=Chung+L%C3%B2ng+M%C3%B9a+L%C5%A9" 
                             alt="Chung lòng mùa lũ" class="img-fluid rounded-4">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="stats-section mb-4">
        <div class="row g-4">
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon danger">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                    </div>
                    <div class="stat-value">24</div>
                    <div class="stat-label">Yêu cầu SOS khẩn cấp</div>
                    <a href="/SOS" class="stat-link">Xem chi tiết →</a>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon success">
                        <i class="fa-solid fa-warehouse"></i>
                    </div>
                    <div class="stat-value">8</div>
                    <div class="stat-label">Kho cứu trợ hoạt động</div>
                    <a href="/Map" class="stat-link">Xem trên bản đồ →</a>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon primary">
                        <i class="fa-solid fa-users"></i>
                    </div>
                    <div class="stat-value">156</div>
                    <div class="stat-label">Tình nguyện viên sẵn sàng</div>
                    <a href="/Volunteer" class="stat-link">Đăng ký ngay →</a>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon warning">
                        <i class="fa-solid fa-hand-holding-heart"></i>
                    </div>
                    <div class="stat-value">1,245</div>
                    <div class="stat-label">Lượt quyên góp</div>
                    <a href="/Sponsor" class="stat-link">Quyên góp →</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content Grid -->
    <div class="row g-4">
        <!-- Recent SOS Requests -->
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fa-solid fa-bell text-danger me-2"></i>Yêu cầu cứu trợ gần đây
                    </h5>
                    <a href="/SOS" class="btn btn-sm btn-outline-primary">Xem tất cả</a>
                </div>
                <div class="card-body p-0">
                    <div class="sos-list-compact" id="recentSOS">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>

            <!-- Relief Map Preview -->
            <div class="card mt-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fa-solid fa-map-location-dot text-primary me-2"></i>Bản đồ cứu trợ
                    </h5>
                    <a href="/Map" class="btn btn-sm btn-outline-primary">Xem chi tiết</a>
                </div>
                <div class="card-body p-0">
                    <div class="map-preview" id="homeMap" style="height: 300px;"></div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Category Cards -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fa-solid fa-boxes-stacked me-2"></i>Nhu cầu cứu trợ
                    </h5>
                </div>
                <div class="card-body">
                    <div class="category-cards">
                        <div class="category-card">
                            <div class="category-icon food">
                                <i class="fa-solid fa-bowl-rice"></i>
                            </div>
                            <div class="category-info">
                                <span class="category-name">Lương thực</span>
                                <span class="category-count">12 yêu cầu</span>
                            </div>
                        </div>
                        <div class="category-card">
                            <div class="category-icon medical">
                                <i class="fa-solid fa-kit-medical"></i>
                            </div>
                            <div class="category-info">
                                <span class="category-name">Y tế</span>
                                <span class="category-count">8 yêu cầu</span>
                            </div>
                        </div>
                        <div class="category-card">
                            <div class="category-icon transport">
                                <i class="fa-solid fa-truck"></i>
                            </div>
                            <div class="category-info">
                                <span class="category-name">Vận chuyển</span>
                                <span class="category-count">5 yêu cầu</span>
                            </div>
                        </div>
                        <div class="category-card">
                            <div class="category-icon shelter">
                                <i class="fa-solid fa-house"></i>
                            </div>
                            <div class="category-info">
                                <span class="category-name">Chỗ ở</span>
                                <span class="category-count">3 yêu cầu</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fa-solid fa-bolt me-2"></i>Hành động nhanh
                    </h5>
                </div>
                <div class="card-body">
                    <div class="quick-actions">
                        <a href="/SOS/Create" class="quick-action-btn danger">
                            <i class="fa-solid fa-paper-plane"></i>
                            <span>Gửi yêu cầu SOS</span>
                        </a>
                        <a href="/Sponsor" class="quick-action-btn primary">
                            <i class="fa-solid fa-heart"></i>
                            <span>Quyên góp ngay</span>
                        </a>
                        <a href="/Volunteer" class="quick-action-btn success">
                            <i class="fa-solid fa-user-plus"></i>
                            <span>Đăng ký TNV</span>
                        </a>
                        <a href="/Map" class="quick-action-btn warning">
                            <i class="fa-solid fa-location-dot"></i>
                            <span>Báo mực nước</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Emergency Contacts -->
            <div class="card emergency-card">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <i class="fa-solid fa-phone-volume me-2"></i>Số điện thoại khẩn cấp
                    </h5>
                </div>
                <div class="card-body">
                    <div class="emergency-numbers">
                        <a href="tel:113" class="emergency-number">
                            <i class="fa-solid fa-shield-halved"></i>
                            <span>113</span>
                            <small>Công an</small>
                        </a>
                        <a href="tel:114" class="emergency-number">
                            <i class="fa-solid fa-fire-extinguisher"></i>
                            <span>114</span>
                            <small>Cứu hỏa</small>
                        </a>
                        <a href="tel:115" class="emergency-number">
                            <i class="fa-solid fa-truck-medical"></i>
                            <span>115</span>
                            <small>Cấp cứu</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
<style>
    .hero-section {
        background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(37, 99, 235, 0.1) 100%);
        padding: 40px;
        border-radius: 16px;
    }

    .hero-badge {
        display: inline-flex;
        align-items: center;
        background: white;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--success-color);
        margin-bottom: 16px;
        box-shadow: var(--shadow-sm);
    }

    .hero-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 16px;
    }

    .hero-description {
        font-size: 1.1rem;
        color: var(--text-secondary);
        line-height: 1.7;
        margin-bottom: 24px;
    }

    .hero-stats {
        display: flex;
        gap: 32px;
        margin-bottom: 24px;
    }

    .hero-stat {
        display: flex;
        flex-direction: column;
    }

    .hero-stat .stat-number {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--primary-color);
    }

    .hero-stat .stat-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
    }

    .hero-actions {
        display: flex;
        gap: 12px;
    }

    .hero-image img {
        box-shadow: var(--shadow-lg);
    }

    .stat-card {
        padding: 24px;
        border-radius: 12px;
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        transition: all var(--transition-fast);
    }

    .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
    }

    .stat-link {
        font-size: 0.85rem;
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
    }

    .stat-link:hover {
        text-decoration: underline;
    }

    .sos-list-compact {
        max-height: 400px;
        overflow-y: auto;
    }

    .sos-item-compact {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color);
        transition: background var(--transition-fast);
    }

    .sos-item-compact:hover {
        background: var(--bg-color);
    }

    .sos-item-compact:last-child {
        border-bottom: none;
    }

    .sos-status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        flex-shrink: 0;
    }

    .sos-status-indicator.urgent {
        background: var(--danger-color);
        animation: blink 1s infinite;
    }

    .sos-status-indicator.pending {
        background: var(--warning-color);
    }

    .sos-status-indicator.resolved {
        background: var(--success-color);
    }

    .category-cards {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .category-card {
        display: flex;
        align-items: center;
        gap: 14px;
        padding: 12px;
        background: var(--bg-color);
        border-radius: 10px;
        cursor: pointer;
        transition: all var(--transition-fast);
    }

    .category-card:hover {
        transform: translateX(4px);
    }

    .category-icon {
        width: 44px;
        height: 44px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
    }

    .category-icon.food { background: #fef3c7; color: #d97706; }
    .category-icon.medical { background: #fce7f3; color: #db2777; }
    .category-icon.transport { background: #dbeafe; color: #2563eb; }
    .category-icon.shelter { background: #d1fae5; color: #059669; }

    .category-info {
        display: flex;
        flex-direction: column;
    }

    .category-name {
        font-weight: 600;
        color: var(--text-primary);
    }

    .category-count {
        font-size: 0.85rem;
        color: var(--text-secondary);
    }

    .quick-actions {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }

    .quick-action-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 16px;
        border-radius: 12px;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.85rem;
        transition: all var(--transition-fast);
    }

    .quick-action-btn i {
        font-size: 1.5rem;
    }

    .quick-action-btn.danger {
        background: #fef2f2;
        color: var(--danger-color);
    }

    .quick-action-btn.primary {
        background: #eff6ff;
        color: var(--primary-color);
    }

    .quick-action-btn.success {
        background: #f0fdf4;
        color: var(--success-color);
    }

    .quick-action-btn.warning {
        background: #fffbeb;
        color: var(--warning-color);
    }

    .quick-action-btn:hover {
        transform: scale(1.05);
    }

    .emergency-card {
        border-color: var(--danger-color);
    }

    .emergency-numbers {
        display: flex;
        justify-content: space-around;
    }

    .emergency-number {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        text-decoration: none;
        color: var(--danger-color);
        padding: 12px;
        border-radius: 10px;
        transition: background var(--transition-fast);
    }

    .emergency-number:hover {
        background: #fef2f2;
    }

    .emergency-number i {
        font-size: 1.5rem;
    }

    .emergency-number span {
        font-size: 1.5rem;
        font-weight: 700;
    }

    .emergency-number small {
        font-size: 0.75rem;
        color: var(--text-secondary);
    }

    .map-preview {
        border-radius: 0 0 12px 12px;
    }

    @@media (max-width: 991.98px) {
        .hero-stats {
            flex-wrap: wrap;
            gap: 20px;
        }

        .hero-title {
            font-size: 1.75rem;
        }
    }
</style>
}

@section Scripts {
<script>
document.addEventListener('DOMContentLoaded', async function() {
    // Load SOS data
    const response = await fetch('/data/markers.json');
    const data = await response.json();
    
    const sosListEl = document.getElementById('recentSOS');
    const categoryLabels = {
        food: 'Lương thực',
        medical: 'Y tế',
        transport: 'Vận chuyển',
        shelter: 'Chỗ ở'
    };

    data.sosMarkers.forEach(item => {
        sosListEl.innerHTML += `
            <div class="sos-item-compact">
                <div class="sos-status-indicator ${item.status}"></div>
                <div class="flex-grow-1">
                    <div class="fw-bold">${item.title}</div>
                    <div class="small text-muted">
                        <i class="fa-solid fa-location-dot me-1"></i>${item.address}
                    </div>
                </div>
                <span class="badge bg-primary">${categoryLabels[item.category]}</span>
                <small class="text-muted">${JCIRelief.MapUtils.formatRelativeTime(item.timestamp)}</small>
            </div>
        `;
    });

    // Initialize mini map
    const miniMap = L.map('homeMap').setView([16.0544, 108.2022], 5);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap'
    }).addTo(miniMap);

    // Add markers to mini map
    data.sosMarkers.forEach(item => {
        L.marker([item.lat, item.lng]).addTo(miniMap);
    });
});
</script>
}
